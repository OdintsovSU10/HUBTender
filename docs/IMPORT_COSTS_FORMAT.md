# Формат Excel файла для импорта затрат на строительство

## Описание формата

Файл Excel должен содержать следующие столбцы (именно в этом порядке):

1. **Номер категории** - Номер для сортировки (целое число)
2. **Категория затрат** - Название категории затрат (текст)
3. **Единица измерения категории** - Единица измерения для категории (текст)
4. **Вид затраты** - Конкретный вид затраты (текст)
5. **Единица измерения затраты** - Единица измерения для вида затраты (текст)
6. **Локализация** - Место/локация проведения работ (текст)

## Поддерживаемые единицы измерения

- `шт` - штуки
- `м` - метры
- `м2` - квадратные метры
- `м3` - кубические метры
- `кг` - килограммы
- `т` - тонны
- `л` - литры
- `компл` - комплект
- `м.п.` - метры погонные

## Пример структуры файла

| Номер | Категория затрат | Ед. изм. | Вид затраты | Ед. изм. | Локализация |
|-------|-----------------|----------|-------------|----------|-------------|
| 1 | Земляные работы | м3 | Разработка грунта экскаватором | м3 | Москва |
| 1 | Земляные работы | м3 | Вывоз грунта | м3 | Москва |
| 1 | Земляные работы | м3 | Обратная засыпка | м3 | Санкт-Петербург |
| 2 | Фундаментные работы | м3 | Устройство монолитного фундамента | м3 | Москва |
| 2 | Фундаментные работы | м3 | Армирование фундамента | т | Москва |
| 3 | Каркас здания | т | Монтаж металлоконструкций | т | Екатеринбург |
| 3 | Каркас здания | т | Сварочные работы | м.п. | Екатеринбург |
| 4 | Кровельные работы | м2 | Монтаж металлочерепицы | м2 | Москва |
| 4 | Кровельные работы | м2 | Устройство гидроизоляции | м2 | Москва |

## Важные замечания

1. **Первая строка** должна содержать заголовки столбцов (они будут пропущены при импорте)
2. **Номер категории** используется для сортировки записей в таблице
3. **Категории с одинаковыми номерами** будут сгруппированы вместе
4. **Дублирующиеся записи** (с одинаковыми категорией, видом затрат и локализацией) будут пропущены
5. **Новые локации и категории** будут автоматически созданы при импорте

## Процесс импорта

При импорте данные распределяются по следующим таблицам БД:

- **cost_categories** - Уникальные категории затрат (столбцы 2 и 3)
- **locations** - Уникальные локализации (столбец 6)
- **detail_cost_categories** - Детальные записи затрат со связями на категории и локации

## Рекомендации

1. Убедитесь, что файл сохранен в формате `.xlsx` или `.xls`
2. Проверьте, что все 6 столбцов заполнены корректно
3. Используйте только поддерживаемые единицы измерения
4. Для больших объемов данных (>1000 строк) импорт может занять некоторое время

## Пример готового файла

Вы можете скачать пример файла для импорта по ссылке:
`[Будет добавлен пример файла]`